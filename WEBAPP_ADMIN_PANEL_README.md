# راهنمای پنل مدیریت مینی اپ

این پنل برای مدیریت کامل مینی اپ (Web App) طراحی شده است و شامل تمام امکانات مورد نیاز برای سفارشی‌سازی مینی اپ است.

## 📋 امکانات

### 1. 🎨 مدیریت رنگ‌بندی
- تنظیم رنگ اصلی (Primary Color)
- تنظیم رنگ ثانویه (Secondary Color)
- تنظیم رنگ پس‌زمینه (Background Color)
- تنظیم رنگ متن (Text Color)
- تنظیم رنگ تاکیدی (Accent Color)
- تنظیم رنگ حاشیه (Border Color)

### 2. 🖼️ مدیریت لوگو
- آپلود لوگو (فایل تصویری)
- تنظیم آدرس لوگو (URL)
- تنظیم عرض و ارتفاع لوگو
- پیش‌نمایش لوگو

### 3. 📋 مدیریت منوها
- افزودن/حذف آیتم‌های منو
- تنظیم عنوان، لینک و آیکون برای هر آیتم
- پشتیبانی از emoji برای آیکون‌ها

### 4. 🏠 مدیریت صفحه اصلی
- انتخاب نوع چیدمان (پیش‌فرض، شبکه‌ای، لیستی)
- نمایش/عدم نمایش محبوب‌ترین‌ها
- نمایش/عدم نمایش جدیدترین‌ها
- نمایش/عدم نمایش دسته‌بندی‌ها

### 5. 🔍 مدیریت فیلترها
- فعال/غیرفعال کردن فیلتر محبوب‌ترین‌ها
- فعال/غیرفعال کردن فیلتر پر بازدیدترین‌ها
- فعال/غیرفعال کردن فیلتر جدیدترین‌ها
- تنظیم تعداد نمایش برای هر فیلتر

## 🚀 نصب و راه‌اندازی

### مرحله 1: ایجاد جدول دیتابیس

فایل `CREATE_WEBAPP_SETTINGS_TABLE.sql` را در phpMyAdmin یا MySQL CLI اجرا کنید:

```bash
mysql -u username -p database_name < CREATE_WEBAPP_SETTINGS_TABLE.sql
```

یا در phpMyAdmin:
1. وارد phpMyAdmin شوید
2. دیتابیس خود را انتخاب کنید
3. روی تب "SQL" کلیک کنید
4. محتوای فایل `CREATE_WEBAPP_SETTINGS_TABLE.sql` را کپی و اجرا کنید

### مرحله 2: دسترسی به پنل

1. وارد پنل مدیریت شوید
2. از منوی سمت راست، روی "مدیریت مینی اپ" کلیک کنید
3. یا مستقیماً به آدرس `admin-panel/webapp.php` بروید

## 📖 نحوه استفاده

### مدیریت رنگ‌بندی

1. روی تب "🎨 رنگ‌بندی" کلیک کنید
2. برای هر رنگ، می‌توانید:
   - از color picker استفاده کنید
   - یا مقدار hex را مستقیماً وارد کنید
3. روی دکمه "💾 ذخیره تغییرات" کلیک کنید

### مدیریت لوگو

1. روی تب "🖼️ لوگو" کلیک کنید
2. می‌توانید:
   - آدرس لوگو را وارد کنید (URL)
   - یا فایل لوگو را آپلود کنید
3. عرض و ارتفاع را تنظیم کنید
4. روی دکمه "💾 ذخیره تغییرات" کلیک کنید

**نکته:** فایل‌های آپلود شده در `web/assets/uploads/` ذخیره می‌شوند.

### مدیریت منوها

1. روی تب "📋 منوها" کلیک کنید
2. برای افزودن آیتم جدید:
   - روی دکمه "➕ افزودن آیتم منو" کلیک کنید
   - عنوان، لینک و آیکون (emoji) را وارد کنید
3. برای حذف آیتم:
   - روی دکمه "حذف" در کنار آیتم کلیک کنید
4. روی دکمه "💾 ذخیره تغییرات" کلیک کنید

### مدیریت صفحه اصلی

1. روی تب "🏠 صفحه اصلی" کلیک کنید
2. نوع چیدمان را انتخاب کنید
3. بخش‌های مورد نظر را فعال/غیرفعال کنید
4. روی دکمه "💾 ذخیره تغییرات" کلیک کنید

### مدیریت فیلترها

1. روی تب "🔍 فیلترها" کلیک کنید
2. فیلترهای مورد نظر را فعال/غیرفعال کنید
3. تعداد نمایش برای هر فیلتر را تنظیم کنید
4. روی دکمه "💾 ذخیره تغییرات" کلیک کنید

## 🗄️ ساختار دیتابیس

جدول `sp_webapp_settings` شامل فیلدهای زیر است:

- `id`: شناسه یکتا
- `setting_key`: کلید تنظیمات (منحصر به فرد)
- `setting_value`: مقدار تنظیمات
- `setting_type`: نوع (color, image, text, json, boolean)
- `category`: دسته (colors, logo, menu, homepage, filters)
- `description`: توضیحات
- `created_at`: تاریخ ایجاد
- `updated_at`: تاریخ به‌روزرسانی

## 📝 فایل‌های ایجاد شده

1. **CREATE_WEBAPP_SETTINGS_TABLE.sql**: فایل SQL برای ایجاد جدول
2. **admin-panel/webapp.php**: صفحه اصلی مدیریت مینی اپ
3. **admin-panel/src/webapp.php**: محتوای صفحه مدیریت
4. **admin-panel/src/webapp_action.php**: پردازش فرم‌ها
5. **admin-panel/src/nav.php**: به‌روزرسانی منوی ناوبری

## 🔧 استفاده در مینی اپ

برای استفاده از تنظیمات در مینی اپ، می‌توانید از توابع زیر استفاده کنید:

```php
// دریافت تنظیمات
function get_webapp_setting($key, $default = '') {
    global $pdo;
    $sql = "SELECT setting_value FROM sp_webapp_settings WHERE setting_key = :key LIMIT 1";
    $stmt = $pdo->prepare($sql);
    $stmt->bindValue(':key', $key, PDO::PARAM_STR);
    $stmt->execute();
    $result = $stmt->fetch(PDO::FETCH_ASSOC);
    return $result ? $result['setting_value'] : $default;
}

// مثال استفاده
$primary_color = get_webapp_setting('primary_color', '#000000');
$logo_url = get_webapp_setting('logo_url', '');
```

## ⚠️ نکات مهم

1. **پشتیبان‌گیری:** قبل از هر تغییر مهم، از دیتابیس بکاپ بگیرید
2. **فایل‌های آپلود:** مطمئن شوید که پوشه `web/assets/uploads/` قابل نوشتن است (chmod 755)
3. **امنیت:** فایل‌های آپلود شده باید بررسی شوند (فقط تصاویر مجاز)
4. **JSON:** منوها و بخش‌های صفحه اصلی به صورت JSON ذخیره می‌شوند

## 🐛 رفع مشکلات

### مشکل: فایل لوگو آپلود نمی‌شود
- بررسی کنید که پوشه `web/assets/uploads/` وجود دارد
- بررسی کنید که پوشه قابل نوشتن است (chmod 755)
- بررسی کنید که فرم enctype="multipart/form-data" است

### مشکل: رنگ‌ها ذخیره نمی‌شوند
- بررسی کنید که جدول `sp_webapp_settings` ایجاد شده است
- بررسی کنید که charset جدول `utf8mb4` است

### مشکل: منوها نمایش داده نمی‌شوند
- بررسی کنید که JSON معتبر است
- بررسی کنید که در مینی اپ از تابع `get_webapp_setting` استفاده می‌کنید

## ✅ چک‌لیست

- [ ] جدول `sp_webapp_settings` ایجاد شد
- [ ] فایل‌های PHP ایجاد شدند
- [ ] منوی ناوبری به‌روزرسانی شد
- [ ] پوشه `web/assets/uploads/` ایجاد شد
- [ ] دسترسی نوشتن به پوشه uploads تنظیم شد
- [ ] پنل مدیریت قابل دسترسی است
- [ ] تمام تب‌ها کار می‌کنند
- [ ] ذخیره تنظیمات کار می‌کند

---

**تاریخ ایجاد:** 2024
**نسخه:** 1.0.0

